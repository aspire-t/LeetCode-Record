# äºŒå‰æœç´¢æ ‘

**æœ€é‡è¦çš„ç‰¹æ€§äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†åºåˆ—æ˜¯æœ‰åºçš„ï¼**

## [98_éªŒè¯äºŒå‰æœç´¢æ ‘](https://leetcode-cn.com/problems/validate-binary-search-tree/)

```js
var isValidBST = function(root) {
    // å®šä¹‰é€’å½’å‡½æ•°
    function dfs(root, minValue, maxValue) {
        // è‹¥æ˜¯ç©ºæ ‘ï¼Œåˆ™åˆæ³•
        if(!root) {
            return true
        }
        // è‹¥å³å­©å­ä¸å¤§äºæ ¹ç»“ç‚¹å€¼ï¼Œæˆ–è€…å·¦å­©å­ä¸å°äºæ ¹ç»“ç‚¹å€¼ï¼Œåˆ™ä¸åˆæ³•
        if(root.val <= minValue || root.val >= maxValue) return false
        // å·¦å³å­æ ‘å¿…é¡»éƒ½ç¬¦åˆäºŒå‰æœç´¢æ ‘çš„æ•°æ®åŸŸå¤§å°å…³ç³»
        return dfs(root.left, minValue,root.val) && dfs(root.right, root.val, maxValue)
    }
    // åˆå§‹åŒ–æœ€å°å€¼å’Œæœ€å¤§å€¼ä¸ºæå°æˆ–æå¤§
    return dfs(root, -Infinity, Infinity)
}
```



## [450_åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„èŠ‚ç‚¹](https://leetcode-cn.com/problems/delete-node-in-a-bst/)

æƒ³è¦åˆ é™¤æŸä¸ªç»“ç‚¹ï¼Œé¦–å…ˆè¦æ‰¾åˆ°è¿™ä¸ªç»“ç‚¹ã€‚åœ¨å®šä½ç»“ç‚¹åï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š

1. ç»“ç‚¹ä¸å­˜åœ¨ï¼Œå®šä½åˆ°äº†ç©ºç»“ç‚¹ã€‚ç›´æ¥è¿”å›å³å¯ã€‚
2. éœ€è¦åˆ é™¤çš„ç›®æ ‡ç»“ç‚¹æ²¡æœ‰å·¦å­©å­ä¹Ÿæ²¡æœ‰å³å­©å­â€”â€”å®ƒæ˜¯ä¸€ä¸ªå¶å­ç»“ç‚¹ï¼Œåˆ æ‰å®ƒä¸ä¼šå¯¹å…¶å®ƒç»“ç‚¹é€ æˆä»»ä½•å½±å“ï¼Œç›´æ¥åˆ é™¤å³å¯ã€‚
3. éœ€è¦åˆ é™¤çš„ç›®æ ‡ç»“ç‚¹å­˜åœ¨å·¦å­æ ‘ï¼Œé‚£ä¹ˆå°±å»å·¦å­æ ‘é‡Œå¯»æ‰¾å°äºç›®æ ‡ç»“ç‚¹å€¼çš„æœ€å¤§ç»“ç‚¹ï¼Œç”¨è¿™ä¸ªç»“ç‚¹è¦†ç›–æ‰ç›®æ ‡ç»“ç‚¹
4. éœ€è¦åˆ é™¤çš„ç›®æ ‡ç»“ç‚¹å­˜åœ¨å³å­æ ‘ï¼Œé‚£ä¹ˆå°±å»å³å­æ ‘é‡Œå¯»æ‰¾å¤§äºç›®æ ‡ç»“ç‚¹å€¼çš„æœ€å°ç»“ç‚¹ï¼Œç”¨è¿™ä¸ªç»“ç‚¹è¦†ç›–æ‰ç›®æ ‡ç»“ç‚¹
5. éœ€è¦åˆ é™¤çš„ç›®æ ‡ç»“ç‚¹æ—¢æœ‰å·¦å­æ ‘ã€åˆæœ‰å³å­æ ‘ï¼Œè¿™æ—¶å°±æœ‰ä¸¤ç§åšæ³•äº†ï¼šè¦ä¹ˆå–å·¦å­æ ‘ä¸­å€¼æœ€å¤§çš„ç»“ç‚¹ï¼Œè¦ä¹ˆå–å³å­æ ‘ä¸­å–å€¼æœ€å°çš„ç»“ç‚¹ã€‚ä¸¤ä¸ªç»“ç‚¹ä¸­ä»»å–ä¸€ä¸ªè¦†ç›–æ‰ç›®æ ‡ç»“ç‚¹ï¼Œéƒ½å¯ä»¥ç»´æŒäºŒå‰æœç´¢æ ‘çš„æ•°æ®æœ‰åºæ€§

```js
/**
 * Definition for a binary tree node.
 * function TreeNode(val, left, right) {
 *     this.val = (val===undefined ? 0 : val)
 *     this.left = (left===undefined ? null : left)
 *     this.right = (right===undefined ? null : right)
 * }
 */
/**
 * @param {TreeNode} root
 * @param {number} key
 * @return {TreeNode}
 */
var deleteNode = function (root, n) {
    // å¦‚æœæ²¡æ‰¾åˆ°ç›®æ ‡ç»“ç‚¹ï¼Œåˆ™ç›´æ¥è¿”å›
    if(!root) {
        return root
    }
    // å®šä½åˆ°ç›®æ ‡ç»“ç‚¹ï¼Œå¼€å§‹åˆ†æƒ…å†µå¤„ç†åˆ é™¤åŠ¨ä½œ
    if(root.val === n) {
        // è‹¥æ˜¯å¶å­ç»“ç‚¹ï¼Œåˆ™ä¸éœ€è¦æƒ³å¤ªå¤šï¼Œç›´æ¥åˆ é™¤
        if(!root.left && !root.right) {
            root = null
        } else if(root.left) {
            // å¯»æ‰¾å·¦å­æ ‘é‡Œå€¼æœ€å¤§çš„ç»“ç‚¹
            const maxLeft = findMax(root.left)
            // ç”¨è¿™ä¸ª maxLeft è¦†ç›–æ‰éœ€è¦åˆ é™¤çš„å½“å‰ç»“ç‚¹  
            root.val = maxLeft.val
            // è¦†ç›–åŠ¨ä½œä¼šæ¶ˆè€—æ‰åŸæœ‰çš„ maxLeft ç»“ç‚¹
            root.left = deleteNode(root.left, maxLeft.val)
        } else {
            // å¯»æ‰¾å³å­æ ‘é‡Œå€¼æœ€å°çš„ç»“ç‚¹
            const minRight = findMin(root.right)
            // ç”¨è¿™ä¸ª minRight è¦†ç›–æ‰éœ€è¦åˆ é™¤çš„å½“å‰ç»“ç‚¹  
            root.val = minRight.val
            // è¦†ç›–åŠ¨ä½œä¼šæ¶ˆè€—æ‰åŸæœ‰çš„ minRight ç»“ç‚¹
            root.right = deleteNode(root.right, minRight.val)
        }
    } else if(root.val > n) {
        // è‹¥å½“å‰ç»“ç‚¹çš„å€¼æ¯” n å¤§ï¼Œåˆ™åœ¨å·¦å­æ ‘ä¸­ç»§ç»­å¯»æ‰¾ç›®æ ‡ç»“ç‚¹
        root.left = deleteNode(root.left, n)
    } else  {
        // è‹¥å½“å‰ç»“ç‚¹çš„å€¼æ¯” n å°ï¼Œåˆ™åœ¨å³å­æ ‘ä¸­ç»§ç»­å¯»æ‰¾ç›®æ ‡ç»“ç‚¹
        root.right = deleteNode(root.right, n)
    }
    return root
}

// å¯»æ‰¾å·¦å­æ ‘æœ€å¤§å€¼
function findMax(root) {
    while(root.right) {
        root = root.right
    }
    return root 
}

// å¯»æ‰¾å³å­æ ‘çš„æœ€å°å€¼
function findMin(root) {
    while(root.left) {
        root = root.left
    }
    return root
}
```



## [701_äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ](https://leetcode-cn.com/problems/insert-into-a-binary-search-tree/)

```js
/**
 * Definition for a binary tree node.
 * function TreeNode(val, left, right) {
 *     this.val = (val===undefined ? 0 : val)
 *     this.left = (left===undefined ? null : left)
 *     this.right = (right===undefined ? null : right)
 * }
 */
/**
 * @param {TreeNode} root
 * @param {number} val
 * @return {TreeNode}
 */
var insertIntoBST = function insertIntoBST(root, n) {
  // è‹¥ root ä¸ºç©ºï¼Œè¯´æ˜å½“å‰æ˜¯ä¸€ä¸ªå¯ä»¥æ’å…¥çš„ç©ºä½
  if(!root) { 
    // ç”¨ä¸€ä¸ªå€¼ä¸ºnçš„ç»“ç‚¹å æ®è¿™ä¸ªç©ºä½
    root = new TreeNode(n)
    return root
  }
  
  if(root.val > n) {
    // å½“å‰ç»“ç‚¹æ•°æ®åŸŸå¤§äºnï¼Œå‘å·¦æŸ¥æ‰¾
    root.left = insertIntoBST(root.left, n)
  } else {
    // å½“å‰ç»“ç‚¹æ•°æ®åŸŸå°äºnï¼Œå‘å³æŸ¥æ‰¾
    root.right = insertIntoBST(root.right, n)
  }

  // è¿”å›æ’å…¥åäºŒå‰æœç´¢æ ‘çš„æ ¹ç»“ç‚¹
  return root
}
```

## [1008. å‰åºéå†æ„é€ äºŒå‰æœç´¢æ ‘](https://leetcode-cn.com/problems/construct-binary-search-tree-from-preorder-traversal/)



## [å‰‘æŒ‡ Offer 33. äºŒå‰æœç´¢æ ‘çš„ååºéå†åºåˆ—](https://leetcode-cn.com/problems/er-cha-sou-suo-shu-de-hou-xu-bian-li-xu-lie-lcof/)

### æ–¹æ³•ä¸€ï¼šé€’å½’

![](K:\Coder\ç¬”è®°\LeetCodeåˆ·é¢˜\images\å‰‘æŒ‡Offer\33.png)

```js
/**
 * @param {number[]} postorder
 * @return {boolean}
 */
const func = (postorder, i, j) => {
  if (i >= j) return true
  let m = i
  // å¦‚ï¼š [1,3,2,6,5]ï¼Œååºéå† 5æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹å·¦è¾¹çš„å€¼åº”è¯¥éƒ½å°äº5ï¼Œå³è¾¹å¤§äº5
  // åˆ†æˆä¸¤éƒ¨åˆ†[1,3,2] <5; [6] >5
  // ç„¶åå†å¯¹ä¸¤éƒ¨åˆ†é€’å½’
  while (postorder[m] < postorder[j]) m++
  // æ£€æŸ¥ä»måˆ°jæ˜¯å¦å­˜åœ¨å°äºpostorder[j]çš„å€¼
  for (let k = m; k < j; k++) {
    // ä»måˆ°jå­˜åœ¨å°äºpostorder[j]çš„å€¼,ä¸ç¬¦åˆäºŒå‰æœç´¢æ ‘
    if (postorder[k] < postorder[j]) return false
  }
  return func(postorder, i, m - 1) && func(postorder, m, j - 1)
}

var verifyPostorder = function (postorder) {
  return func(postorder, 0, postorder.length - 1)
}
```

### æ–¹æ³•äºŒï¼šå•è°ƒæ ˆ

ååºéå†å€’åºï¼š [ æ ¹èŠ‚ç‚¹ | å³å­æ ‘ | å·¦å­æ ‘ ] ã€‚ç±»ä¼¼ å…ˆåºéå†çš„é•œåƒ ï¼Œå³å…ˆåºéå†ä¸º â€œæ ¹ã€å·¦ã€å³â€ çš„é¡ºåºï¼Œè€Œååºéå†çš„å€’åºä¸º â€œæ ¹ã€å³ã€å·¦â€ é¡ºåºã€‚

```js
/**
 * @param {number[]} postorder
 * @return {boolean}
 */
var verifyPostorder = function(postorder) {
    let stack = [], root = Infinity
    for(let i = postorder.length - 1; i > - 1; i--) {
        if (postorder[i] > root) return false
        while(stack.length > 0 && postorder[i] < stack[stack.length - 1]) {
            root = stack.pop()
        }
        stack.push(postorder[i])
    }
    return true
}
```

## [å‰‘æŒ‡ Offer 68 - I. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ](https://leetcode-cn.com/problems/er-cha-sou-suo-shu-de-zui-jin-gong-gong-zu-xian-lcof/)

## [235. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ](https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree/)

### æ–¹æ³•ä¸€ï¼šéé€’å½’

- åˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„ç‰¹ç‚¹
- é¦–å…ˆåˆ¤æ–­ p å’Œ q æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ç›¸ç­‰ï¼Œåˆ™ç›´æ¥è¿”å› p æˆ– q ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œç¨‹åºç»“æŸ

- è‹¥ä¸ç›¸ç­‰ï¼Œåˆ™åˆ¤æ–­ p å’Œ q åœ¨å‘å·¦è¿˜æ˜¯å‘å³çš„é—®é¢˜ä¸Šï¼Œæ˜¯å¦è¾¾æˆäº†ä¸€è‡´
  - å¦‚æœ p å’Œ q éƒ½å°äºroot, å“¥ä¿©ä¸€è‡´è®¤ä¸ºå‘å·¦ğŸ‘ˆï¼Œåˆ™ root = root.left
  - å¦‚æœ p å’Œ q éƒ½å¤§äºroot, å“¥ä¿©ä¸€è‡´è®¤ä¸ºå‘å³ğŸ‘‰ï¼Œåˆ™ root = root.right
  - å¦‚æœ p å’Œ q å“¥ä¿©å¯¹ä¸‹ä¸€æ­¥çš„è·¯çº¿å‡ºç°äº†åˆ†æ­§ï¼Œè¯´æ˜ p å’Œ q åœ¨å½“å‰çš„èŠ‚ç‚¹ä¸Šå°±è¦åˆ†é“æ‰¬é•³äº†ï¼Œå½“å‰çš„ root æ˜¯å“¥ä¿©ä¸´åˆ«å‰ä¸€èµ·èµ°çš„æœ€åä¸€ç«™
  - è¿”å›å½“å‰ root
  - ç¨‹åºç»“æŸ

```js
var lowestCommonAncestor = function (root, p, q) {
    if (!root) {
        return null
    }
    if (p.val === q.val) {
        return q
    }
    while (root) {
        if (root.val < q.val && root.val < p.val) {
            root = root.right
        } else if (root.val > q.val && root.val > p.val) {
            root = root.left
        } else {
            return root
        }
    }
};
```

### æ–¹æ³•äºŒï¼šé€’å½’

```js
const lowestCommonAncestor = (root, p, q) => {
    // é€’å½’å‡ºå£
    if (!root) return root;
    // æ ¹èŠ‚ç‚¹å€¼éƒ½å¤§äºä¸¤ä¸ªæ•°ï¼Œåˆ™éå†å·¦å­æ ‘
    if (root.val > p.val && root.val > q.val) {
        return lowestCommonAncestor(root.left, p, q);
    }
    // æ ¹èŠ‚ç‚¹å€¼éƒ½å°äºä¸¤ä¸ªæ•°ï¼Œåˆ™éå†å³å­æ ‘
    if (root.val < p.val && root.val < q.val) {
        return lowestCommonAncestor(root.right, p, q);
    }
    // å¦åˆ™ï¼Œæ ¹èŠ‚ç‚¹ä¸€å®šåœ¨ä¸­é—´
    return root;
};
```

## [å‰‘æŒ‡ Offer 36. äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨](https://leetcode-cn.com/problems/er-cha-sou-suo-shu-yu-shuang-xiang-lian-biao-lcof/)

### æ–¹æ³•ä¸€ï¼šé€’å½’+ä¸­åºéå†

```js
/**
 * // Definition for a Node.
 * function Node(val,left,right) {
 *    this.val = val;
 *    this.left = left;
 *    this.right = right;
 * };
 */
/**
 * @param {Node} root
 * @return {Node}
 */
// äºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºåŒå‘å¾ªç¯é“¾è¡¨
// è¿™ä¸ªäºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºåŒå‘å¾ªç¯é“¾è¡¨ã€‚é“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå‰é©±å’Œåç»§æŒ‡é’ˆã€‚å¯¹äºåŒå‘å¾ªç¯é“¾è¡¨ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å‰é©±æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹çš„åç»§æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
// åŒå‘é“¾è¡¨ å‰é©±å’Œåç»§çš„æ¦‚å¿µ å…¶å®å°±æ˜¯ä¸­åºéå†+åŒå‘é“¾è¡¨çš„æ“ä½œ
var treeToDoublyList = function (root) {
  if (!root) {
    return null
  }
  let pre = null
  let head = null
  dfs(root)
  // è¿™æ—¶å€™çš„preä¸æ˜¯nullï¼Œè€Œæ˜¯æœ«å°¾èŠ‚ç‚¹å€¼
  // é—­åˆæˆç¯
  pre.right = head
  head.left = pre
  return head
  
  function dfs (root) {
    if (!root) {
      return null
    }
    // ä¸­åºéå†
    dfs(root.left)
    if (pre) {
      pre.right = root
    } else {
      // æ³¨æ„ä¸­åºéå† å¤´ç»“ç‚¹ä¸æ˜¯è¯¥é“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ æ¯”å¦‚[4,2,5,1,3] è‚¯å®šä¸æ˜¯4
      // è¿™é‡Œç¡®å®šå¤´ç»“ç‚¹
      head = root
    }
    root.left = pre
    pre = root
    // éå†å³å­æ ‘
    dfs(root.right)
  }
}
```

### æ–¹æ³•äºŒï¼šéé€’å½’+ä¸­åºéå†

```js
var treeToDoublyList = function(root) {
    if (!root) {
        return;
    }

    const stack = [];
    let node = root;
    let pre = null;
    let head = null;
    while (stack.length || node) {
        if (node) {
            stack.push(node);
            node = node.left;
        } else {
            const top = stack.pop();
            if (!pre) {
                head = top;
            } else {
                pre.right = top;
            }
            top.left = pre;
            pre = top;

            node = top.right;
        }
    }

    head.left = pre;
    pre.right = head;
    return head;
};
```

## [å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹](https://leetcode-cn.com/problems/er-cha-sou-suo-shu-de-di-kda-jie-dian-lcof/)

äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå† å¾—åˆ°çš„æ˜¯å‡åºæ•°ç»„ ç¬¬kä¸ªå¤§èŠ‚ç‚¹
é€†ä¸­åºéå† ä¸éœ€è¦éå†å®Œ å½“éå†åˆ°ç¬¬kä¸ªå°±è¿”å›

1. äºŒå‰æœç´¢æ ‘ é€†ä¸­åºéå†
2. å½“éå†åˆ°ç¬¬kæ¬¡æ—¶è¿”å›å½“å‰å€¼å³å¯

```js
/**
 * Definition for a binary tree node.
 * function TreeNode(val) {
 *     this.val = val;
 *     this.left = this.right = null;
 * }
 */
/**
 * @param {TreeNode} root
 * @param {number} k
 * @return {number}
 */
var kthLargest = function(root, k) {
    /* 
        äºŒå‰æœç´¢æ ‘çš„å‰åºéå† å¾—åˆ°çš„æ˜¯å‡åºæ•°ç»„ ç¬¬kä¸ªå¤§èŠ‚ç‚¹ 
        é€†å‰åºéå† ä¸éœ€è¦éå†å®Œ å½“éå†åˆ°ç¬¬kä¸ªå°±è¿”å›
        1. äºŒå‰æœç´¢æ ‘ é€†å‰åºéå†
        2. å½“éå†åˆ°ç¬¬kæ¬¡æ—¶è¿”å›å½“å‰å€¼å³å¯
    */
    if (!root) return null
    let max = 0 
    const DFS = node => {
        // å½“é‡åˆ°ç©ºèŠ‚ç‚¹æ—¶ é€’å½’ç»ˆæ­¢
        if (!node) return 
        DFS(node.right)
        // å½“éå†kæ¬¡å ç»ˆæ­¢æŸ¥æ‰¾å¹¶ä¸”è®¾ç½®æœ€å¤§å€¼max
        if (!--k) return (max = node.val) 
        DFS(node.left)
    }
    DFS(root)
    return max
};
```

## [230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ ](https://leetcode-cn.com/problems/kth-smallest-element-in-a-bst/)

**æœ€é‡è¦çš„ç‰¹æ€§äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†åºåˆ—æ˜¯æœ‰åºçš„ï¼**

æ‰€ä»¥ç”¨ä¸­åºéå†å³å¯ã€‚

```js
/**
 * @param {TreeNode} root
 * @param {number} k
 * @return {number}
 */
var kthSmallest = function(root, k) {
    if (!root) return null
    let min = 0
    function dfs(root) {
        if (!root) return 
        dfs(root.left)
        if (--k === 0) return (min = root.val) 
        dfs(root.right)
    }
    dfs(root)
    return min
}
```

